<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ğŸŒ¤ï¸ Weather App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    :root{
      --bg:linear-gradient(135deg,#a1c4fd,#c2e9fb);
      --text:#222;
      --card:rgba(255,255,255,.25);
      --glass:rgba(255,255,255,.35);
      --blur:blur(10px);
    }
    body.dark{
      --bg:linear-gradient(135deg,#1e1e1e,#121212);
      --text:#eee;
      --card:rgba(30,30,30,.35);
      --glass:rgba(0,0,0,.25);
      --blur:blur(8px);
    }
    *{box-sizing:border-box}
    body{
      margin:0;padding:0;font-family:'Segoe UI',sans-serif;
      background:var(--bg);color:var(--text);
      min-height:100vh;display:flex;flex-direction:column;align-items:center;
      transition:background .5s,color .3s;
    }
    h1{margin:40px 0 6px;font-size:2.4rem;text-align:center}
    .fixed-btn{
      position:fixed;top:18px;padding:8px 14px;border:none;cursor:pointer;
      backdrop-filter:blur(6px);font-size:1rem;z-index:1000;border-radius:12px;
      background:#ffffff44;box-shadow:0 4px 8px rgba(0,0,0,.2);color:var(--text);
    }
    #themeToggle{right:18px}
    #unitToggle{right:110px}
    .container{
      width:92%;max-width:520px;margin:22px auto 40px;
      background:var(--card);backdrop-filter:var(--blur);border-radius:22px;
      padding:26px;box-shadow:0 15px 35px rgba(0,0,0,.25);text-align:center;
      transition:.4s;
    }
    input,button{
      font-size:1rem;padding:12px 16px;border-radius:10px;border:none;margin:8px 0;
    }
    input{
      width:80%;border:1px solid #ccc;box-shadow:inset 0 1px 3px rgba(0,0,0,.1)
    }
    .search-btn{
      width:100%;background:#4caf50;color:#fff;cursor:pointer;
      box-shadow:0 6px 12px rgba(76,175,80,.45);transition:.3s
    }
    .search-btn:hover{transform:translateY(-2px)}
    .weather-info{text-align:left;font-size:1rem;margin-top:18px}
    #map{height:300px;margin-top:22px;border-radius:18px;
         overflow:hidden;box-shadow:0 8px 18px rgba(0,0,0,.25)}
    .forecast-day{
      margin-top:14px;padding:12px;border-radius:16px;
      background:var(--glass);backdrop-filter:var(--blur);
      box-shadow:0 5px 12px rgba(0,0,0,.15);
      opacity:0;transform:translateY(20px);
      animation:fadeUp .6s forwards;
    }
    @keyframes fadeUp{to{opacity:1;transform:translateY(0)}}
    @media(max-width:600px){
      h1{font-size:2rem}input{width:100%}
    }
  </style>
</head>
<body>

  <button id="unitToggle" class="fixed-btn">Â°F</button>
  <button id="themeToggle" class="fixed-btn">ğŸŒ™</button>

  <h1>ğŸŒ¤ï¸ Weather App</h1>

  <div class="container">
    <input id="locationInput" type="text" placeholder="Enter city (e.g. Delhi)">
    <button class="search-btn" onclick="getWeather()">Get Weather</button>

    <div id="weatherResult" class="weather-info"></div>
    <div id="forecastResult" class="weather-info"></div>
    <div id="map"></div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const apiKey='f5808839414a4235bd263006252007';
    let map,state={raw:null,unit:'C'};

    themeToggle.onclick=()=>document.body.classList.toggle('dark');
    unitToggle.onclick=()=>{
      state.unit=state.unit==='C'?'F':'C';
      unitToggle.textContent=state.unit==='C'?'Â°F':'Â°C';
      if(state.raw) render(state.raw);
    };

    async function getWeather(){
      const loc=document.getElementById('locationInput').value.trim();
      if(!loc) return alert('Enter a location first.');
      const url=`http://api.weatherapi.com/v1/forecast.json?key=${apiKey}&q=${loc}&days=3&aqi=yes`;
      try{
        const res=await fetch(url);
        const data=await res.json();
        if(data.error) return weatherResult.textContent=data.error.message;
        state.raw=data;
        render(data);
      }catch(err){
        weatherResult.textContent='âŒ Error fetching weather.';console.error(err);
      }
    }

    function render(data){
      const {current,location:loc,forecast}=data;
      const useC=state.unit==='C';
      weatherResult.innerHTML=`
        <strong>${loc.name}, ${loc.region}, ${loc.country}</strong><br>
        ğŸ•’ ${loc.localtime}<br>
        ğŸŒ¡ï¸ ${useC?current.temp_c:current.temp_f}Â°${state.unit}
           (FeelsÂ likeÂ ${useC?current.feelslike_c:current.feelslike_f}Â°${state.unit})<br>
        ğŸ’§ Humidity: ${current.humidity}%<br>
        ğŸ’¨ Wind: ${current.wind_kph}Â kph (${current.wind_dir})<br>
        ğŸŒ¥ï¸ ${current.condition.text}
        <img src="https:${current.condition.icon}" alt=""><br>`;
      forecastResult.innerHTML='<h3>â±ï¸ 3â€‘Day Forecast</h3>';
      forecast.forecastday.forEach((d,i)=>{
        const delay=i*0.15;
        forecastResult.innerHTML+=`
          <div class="forecast-day" style="animation-delay:${delay}s">
            ğŸ“… ${d.date}<br>
            ğŸŒ¡ï¸ MaxÂ ${useC?d.day.maxtemp_c:d.day.maxtemp_f}Â°${state.unit}
            |Â MinÂ ${useC?d.day.mintemp_c:d.day.mintemp_f}Â°${state.unit}<br>
            ğŸŒ¥ï¸ ${d.day.condition.text}
            <img src="https:${d.day.condition.icon}" alt="">
          </div>`;
      });
      if(!map){
        map=L.map('map').setView([loc.lat,loc.lon],8);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
      }else map.setView([loc.lat,loc.lon],8);
      L.marker([loc.lat,loc.lon]).addTo(map).bindPopup(loc.name).openPopup();
    }

    if('serviceWorker'in navigator){
      navigator.serviceWorker.register(
        "data:text/javascript,self.addEventListener('fetch',()=>{});"
      );
    }
  </script>
</body>
</html>
